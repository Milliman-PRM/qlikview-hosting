<html class="">
<head>
    <meta charset="UTF-8">
    <meta name="robots" content="noindex">
    <link rel="stylesheet prefetch" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/themes/smoothness/jquery-ui.css">
    <link rel="stylesheet prefetch" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
    <style class="cp-pen-styles">
        .table-editable {
            position: relative;
        }

            .table-editable .glyphicon {
                font-size: 20px;
            }

        .table-remove {
            color: #700;
            cursor: pointer;
        }

            .table-remove:hover {
                color: #f00;
            }

        .table-up, .table-down {
            color: #007;
            cursor: pointer;
        }

            .table-up:hover, .table-down:hover {
                color: #00f;
            }

        .table-add {
            color: #070;
            cursor: pointer;
            position: absolute;
            top: 90px;
            right: 0;
        }

            .table-add:hover {
                color: #0b0;
            }

        .col-wrapper {
            width: 960px;
            margin: 0 auto;
        }

        .col {
            margin: 0 10px;
            float: left;
            display: inline;
        }

        .col-294 {
            width: 294px;
        }

        .col-250 {
            width: 250px;
        }

        ul, ol {
            margin-top: 0;
            margin-bottom: 10px;
            font-family: cursive;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Roche UI Bugs List</h1>
        <h4><b>Instructions</b></h4>
        <ul id="problems">
            <li>Enter Problem Desctiption</li>
            <li>Enter UI Name</li>
            <li>Export to Excel</li>
            <li><i>Note:</i> This web page does not save data so please make sure to Export to Excel</li>
            <content>
                <ul>
                    <div class="col-wrapper">
                        <div class="col col-294">
                            <li>Searh Menu</li>
                            <li>Search Menu - Analyzer</li>
                            <li>Search Menu - Assay Description</li>
                            <li>Search Menu - Locality</li>
                            <li>Year Drop Down</li>
                            <li>Grid Column</li>
                        </div>
                        <div class="col col-250">
                            <li><OPTION value="ch">Gid Pagging</OPTION></li>
                            <li><OPTION value="ch">Grid Sorting</OPTION></li>
                            <li><OPTION value="ch">Notes</OPTION></li>
                            <li><OPTION value="ch">Web URl</OPTION></li>
                            <li><OPTION value="ch">Other</OPTION></li>
                        </div>
                    </div>
                </ul>
            </content>
        </ul>

        <div id="table" class="table-editable">
            <span class="table-add glyphicon glyphicon-plus"></span>
            <div id="dvData">
                <table class="table">
                    <tbody>
                        <tr>
                            <th>Problem Description</th>
                            <th>UI Name</th>
                            <th></th>
                            <th></th>
                        </tr>
                        <tr>
                            <td contenteditable="true">Problem</td>
                            <td contenteditable="true">Name</td>
                            <!--<td contenteditable="true" onchange="selectedItem();">
                                <select name="country">
                                    <OPTION value="in">Select Item</OPTION>
                                    <OPTION value="in">Searh Menu</OPTION>
                                    <OPTION value="de">Search Menu - Analyzer</OPTION>
                                    <OPTION value="de">Search Menu - Assay Description</OPTION>
                                    <OPTION value="de">Search Menu - Locality</OPTION>
                                    <OPTION value="ch">Year Drop Down</OPTION>
                                    <OPTION value="ch">Grid Column</OPTION>
                                    <OPTION value="ch">Gid Pagging</OPTION>
                                    <OPTION value="ch">Grid Sorting</OPTION>
                                    <OPTION value="ch">Notes</OPTION>
                                    <OPTION value="ch">Web URl</OPTION>
                                    <OPTION value="ch">Other</OPTION>
                                </select>
                            </td>-->
                            <td>
                                <span class="table-remove glyphicon glyphicon-remove"></span>
                            </td>
                            <td>
                                <span class="table-up glyphicon glyphicon-arrow-up"></span>
                                <span class="table-down glyphicon glyphicon-arrow-down"></span>
                            </td>
                        </tr>
                        <!-- This is our clonable table line -->
                        <tr class="hide">
                            <td contenteditable="true">Problem</td>
                            <td contenteditable="true">Name</td>
                            <!--<td contenteditable="true">
                                <SELECT name="country">
                                    <OPTION value="in">Searh Menu</OPTION>
                                    <OPTION value="de">Search Menu - Analyzer</OPTION>
                                    <OPTION value="de">Search Menu - Assay Description</OPTION>
                                    <OPTION value="de">Search Menu - Locality</OPTION>
                                    <OPTION value="ch">Year Drop Down</OPTION>
                                    <OPTION value="ch">Grid Column</OPTION>
                                    <OPTION value="ch">Gid Pagging</OPTION>
                                    <OPTION value="ch">Grid Sorting</OPTION>
                                    <OPTION value="ch">Notes</OPTION>
                                    <OPTION value="ch">Web URl</OPTION>
                                    <OPTION value="ch">Other</OPTION>
                                </SELECT>
                            </td>-->
                            <td>
                                <span class="table-remove glyphicon glyphicon-remove"></span>
                            </td>
                            <td>
                                <span class="table-up glyphicon glyphicon-arrow-up"></span>
                                <span class="table-down glyphicon glyphicon-arrow-down"></span>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <button id="btnExport" class="btn btn-primary" onclick="tableToExcel('table', 'W3C Example Table')">Export Data</button>
        <p id="export"></p>
    </div>

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/jquery-ui.min.js"></script>
    <script src="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.6.0/underscore.js"></script>

    <script>
        var $TABLE = $('#table');
        var $BTN = $('#btnExport');
        var $EXPORT = $('#export');

        $('.table-add').click(function () {
            var $clone = $TABLE.find('tr.hide').clone(true).removeClass('hide table-line');
            $TABLE.find('table').append($clone);
        });
        $('.table-remove').click(function () {
            $(this).parents('tr').detach();
        });
        $('.table-up').click(function () {
            var $row = $(this).parents('tr');
            if ($row.index() === 1)
                return;
            $row.prev().before($row.get(0));
        });
        $('.table-down').click(function () {
            var $row = $(this).parents('tr');
            $row.next().after($row.get(0));
        });
        jQuery.fn.pop = [].pop;
        jQuery.fn.shift = [].shift;
        //$BTN.click(function () {
        //    var $rows = $TABLE.find('tr:not(:hidden)');
        //    var headers = [];
        //    var data = [];
        //    $($rows.shift()).find('th:not(:empty)').each(function () {
        //        headers.push($(this).text().toLowerCase());
        //    });
        //    $rows.each(function () {
        //        var $td = $(this).find('td');
        //        var h = {};
        //        headers.forEach(function (header, i) {
        //            h[header] = $td.eq(i).text();
        //        });
        //        data.push(h);
        //    });
        //    $EXPORT.text(JSON.stringify(data));
        //});


        var tableToExcel = (function () {
            var uri = 'data:application/vnd.ms-excel;base64,'
              , template = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--><meta http-equiv="content-type" content="text/plain; charset=UTF-8"/></head><body><table>{table}</table></body></html>'
              , base64 = function (s) { return window.btoa(unescape(encodeURIComponent(s))) }
              , format = function (s, c) { return s.replace(/{(\w+)}/g, function (m, p) { return c[p]; }) }
            return function (table, name) {
                if (!table.nodeType) table = document.getElementById(table)
                var ctx = { worksheet: name || 'Worksheet', table: table.innerHTML }
                window.location.href = uri + base64(format(template, ctx))
            }
        })()
        //# sourceURL=pen.js
    </script>
</body>
</html>